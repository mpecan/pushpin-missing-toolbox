# Sample configuration for Pushpin Security Starter
# Copy and modify these properties to your application.properties

# =============================================================================
# PUSHPIN SECURITY CONFIGURATION
# =============================================================================

# Global security settings
pushpin.security.enabled=true
pushpin.auth-enabled=true

# =============================================================================
# REMOTE AUTHORIZATION
# =============================================================================

# Enable remote authorization service
pushpin.security.remote.enabled=false
pushpin.security.remote.base-url=https://auth.example.com
pushpin.security.remote.timeout=30000
pushpin.security.remote.retry-attempts=3
pushpin.security.remote.retry-delay-ms=1000

# Authorization cache settings
pushpin.security.remote.cache.enabled=true
pushpin.security.remote.cache.max-size=1000
pushpin.security.remote.cache.expire-after-write-minutes=5
pushpin.security.remote.cache.expire-after-access-minutes=10

# =============================================================================
# AUDIT LOGGING
# =============================================================================

# Enable audit logging
pushpin.security.audit.enabled=true
pushpin.security.audit.include-sensitive-data=false
pushpin.security.audit.max-event-length=1000

# =============================================================================
# DATA ENCRYPTION
# =============================================================================

# Enable encryption for sensitive data
pushpin.security.encryption.enabled=false
pushpin.security.encryption.algorithm=AES/GCM/NoPadding
pushpin.security.encryption.key-size=256
# WARNING: Never commit secrets to version control!
# Use environment variables: ${ENCRYPTION_SECRET_KEY}
pushpin.security.encryption.secret-key=

# =============================================================================
# HMAC SIGNING
# =============================================================================

# Enable HMAC signing for server-to-server communication
pushpin.security.hmac.enabled=false
pushpin.security.hmac.algorithm=HmacSHA256
pushpin.security.hmac.header-name=X-Pushpin-Signature
pushpin.security.hmac.max-age-ms=300000
# WARNING: Never commit secrets to version control!
# Use environment variables: ${HMAC_SECRET_KEY}
pushpin.security.hmac.secret-key=

# Paths excluded from HMAC verification
pushpin.security.hmac.excluded-paths[0]=/api/public/
pushpin.security.hmac.excluded-paths[1]=/actuator/
pushpin.security.hmac.excluded-paths[2]=/api/pushpin/auth

# =============================================================================
# JWT PROCESSING
# =============================================================================

# Enable JWT authentication
pushpin.security.jwt.enabled=true

# JWT Provider configuration
# Options: symmetric, keycloak, auth0, okta, oauth2
pushpin.security.jwt.provider=symmetric

# For symmetric provider (development/testing)
# WARNING: Never commit secrets to version control!
# Use environment variables: ${JWT_SECRET_KEY}
# Minimum 32 characters required
pushpin.security.jwt.secret=your-jwt-secret-at-least-32-characters-long

# For OAuth2 providers (production)
# pushpin.security.jwt.jwks-uri=https://your-provider.com/.well-known/jwks.json

# JWT validation settings
pushpin.security.jwt.issuer=
pushpin.security.jwt.audience=

# Authority extraction from JWT
pushpin.security.jwt.authorities-claim=scope
pushpin.security.jwt.authorities-prefix=SCOPE_

# Channel subscription extraction from JWT
pushpin.security.jwt.claim-extraction.enabled=false
pushpin.security.jwt.claim-extraction.extract-claims[0]=$.channels

# =============================================================================
# SPRING SECURITY INTEGRATION
# =============================================================================

# Disable Spring Security's default behavior if needed
# spring.security.user.name=admin
# spring.security.user.password=admin

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Enable debug logging for security modules (development only)
# logging.level.io.github.mpecan.pmt.security=DEBUG

# Audit log pattern (optional)
# logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n